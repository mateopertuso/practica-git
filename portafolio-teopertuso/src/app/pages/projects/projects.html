<section class="relative w-full bg-black text-white">
  <!-- Background -->
  <div
    class="pointer-events-none absolute inset-0 z-0 opacity-20 bg-[radial-gradient(circle_at_top,_var(--tw-gradient-stops))] from-sky-200 via-black to-black"
  ></div>

  <div class="relative z-10 mx-auto max-w-6xl px-6 py-24 animate-fadeInUp">
    <!-- Title -->
    <h2 class="text-4xl font-bold text-center mb-4">
      My
      <span class="text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-sky-900"
        >Projects</span
      >
    </h2>

    <p class="text-center text-gray-400 max-w-2xl mx-auto mb-16">
      A selection of internal and company projects I’ve worked on. Some of them cannot be shared
      publicly, but showcase real-world experience.
    </p>

    <!-- Projects grid -->
    <div class="grid gap-8 sm:grid-cols-2">
      <div
        *ngFor="let project of projects"
        (click)="openProject(project)"
        class="group cursor-pointer rounded-2xl border border-white/10 bg-white/5 backdrop-blur transition hover:-translate-y-1 hover:border-blue-600/50 hover:bg-white/10"
      >
        <!-- Image -->
        <div class="aspect-video overflow-hidden rounded-t-2xl">
          <img
            [src]="project.images[0]"
            alt="project image"
            class="h-full w-full object-cover transition group-hover:scale-105"
          />
        </div>

        <!-- Content -->
        <div class="p-6 space-y-3">
          <h3 class="text-xl font-semibold">{{ project.title }}</h3>
          <p class="text-sm text-gray-400">{{ project.subtitle }}</p>

          <div class="flex flex-wrap gap-2 pt-2">
            <span
              *ngFor="let tech of project.technologies"
              class="rounded-full bg-blue-600 px-3 py-1 text-xs text-white"
            >
              {{ tech }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL -->
  <ng-container *ngIf="selectedProject">
    <div
      class="fixed inset-0 z-[200] flex items-center justify-center bg-black/80 backdrop-blur-sm px-4"
      [ngClass]="isClosing ? 'animate-fadeOutDown' : 'animate-slideDown'"
      (click)="closeProject()"
    >
      <div
        class="relative w-full max-w-4xl rounded-2xl bg-neutral-900 p-6 md:p-8"
        (click)="$event.stopPropagation()"
      >
        <!-- Close -->
        <button
          class="absolute right-4 top-4 text-white/60 hover:text-white text-xl"
          (click)="closeProject()"
        >
          ✕
        </button>

        <!-- Header -->
        <h3 class="text-2xl font-semibold mb-2">
          {{ selectedProject.title }}
        </h3>
        <p class="text-gray-400 mb-6">
          {{ selectedProject.description }}
        </p>

        <!-- Carousel -->
        <div class="relative mb-6 group">
          <!-- Image -->
          <div class="relative overflow-hidden">
            <img
              [src]="selectedProject.images[currentImage]"
              class="w-full h-auto max-h-[70vh] mx-auto object-contain"
              alt="Project screenshot"
            />
          </div>
          <!-- Indicators -->
          <div class="mt-4 flex justify-center gap-2">
            <button
              *ngFor="let _ of selectedProject.images; let i = index"
              (click)="currentImage = i"
              class="h-2.5 w-2.5 rounded-full transition-all"
              [ngClass]="
                i === currentImage ? 'bg-blue-600 scale-110' : 'bg-white/30 hover:bg-white/60'
              "
              aria-label="Go to image {{ i + 1 }}"
            ></button>
          </div>

          <!-- Prev -->
          <button
            class="absolute left-3 top-1/2 -translate-y-1/2 h-10 w-10 flex items-center justify-center rounded-full bg-black/40 backdrop-blur text-white text-xl opacity-0 group-hover:opacity-100 transition-all hover:scale-110 hover:bg-black/70 md:opacity-0"
            (click)="prevImage()"
            aria-label="Previous image"
          >
            ‹
          </button>

          <!-- Next -->
          <button
            class="absolute right-3 top-1/2 -translate-y-1/2 h-10 w-10 flex items-center justify-center rounded-full bg-black/40 backdrop-blur text-white text-xl opacity-0 group-hover:opacity-100 transition-all hover:scale-110 hover:bg-black/70 md:opacity-0"
            (click)="nextImage()"
            aria-label="Next image"
          >
            ›
          </button>
        </div>

        <!-- Footer -->
        <div class="flex flex-wrap justify-between gap-4 items-center">
          <div class="flex flex-wrap gap-2">
            <span
              *ngFor="let tech of selectedProject.technologies"
              class="rounded-full bg-sky-900 px-3 py-1 text-xs text-white"
            >
              {{ tech }}
            </span>
          </div>

          <span *ngIf="selectedProject.companyProject" class="text-xs text-gray-500">
            Company project – source code not publicly available
          </span>
        </div>
      </div>
    </div>
  </ng-container>
</section>
